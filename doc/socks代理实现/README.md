# 目录

# 正文

## 代理

首先，我们要明确什么是代理，我们为什么要使用代理，代理实现的要求是什么。脱开了这些，我们实现代理就没有现实的需求环境了。

代理的出现，主要是为了让我们有一种方式，可以在不改变公司或者区域网络拓扑结构的情况下，用一种迂回的方式访问之前被防火墙或类似机制屏蔽的资源。

一个代理的实现要考虑以下几点要求：

1.  尽量对应用程序透明。在理想情况下，我们的应用直接向服务器资源访问。而在有防火墙的情况下，我们的代理需要对流量作二次转发。这个转发牵扯到对使用代理的应用程序的影响程度，如果我们的代理可以作用在 OSI 模型的更低层级，那么它对应用程序就越透明。例如：VPN 作为在链路层，属于虚拟网卡，其对应用程序完全透明；而 HTTP 代理作用在应用层，使用它就需要配置原始浏览器访问代理服务器，同时需要浏览器可以解析转发流量。但是，作用在越高等级的代理拥有的信息就越多，可以更智能的对代理内容进行优化。例如：HTTP 代理就可以缓存网站信息，更快的向请求代理的用户做出响应；而 VPN 因为没有相关的信息甄别能力，其一视同仁的对待所有的穿过流量，因此不能对特定流量进行优化。
1.  要具有一定的保密性。增加一层转发即增加一层网络暴露风险。代理的实现应该保证认证和加密系统被融合进来，有时可以为非加密的原始流量提供额外的加密能力来达到更安全的能力。
1.  提供多级代理的能力。

我们设想一个环境：用户现在处于一个大型局域网中，可以自由在本局域网中访问资源。而本局域网与外部网络联通的边际路由器中引入了

## socks 代理的实现

socks 代理的实现是
